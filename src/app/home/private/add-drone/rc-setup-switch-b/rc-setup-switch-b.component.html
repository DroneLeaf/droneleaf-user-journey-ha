<div class="flex flex-col lg:flex-row bg-white text-black">
  <!-- Main Left -->
  <div class="flex flex-col flex-1 h-full relative p-10">
    <!-- Top Header -->
    <div class="flex justify-between items-center px-6 py-4">
      <img src="../../../../../assets/svgs/private/Group 1597881310.svg" alt="DroneLeaf Logo" class="h-14" />
      <app-help-button></app-help-button>
    </div>

    <!-- Main Content Area with padding at bottom for fixed buttons -->
    <div class="flex-1 overflow-y-auto px-6 pb-24">
      <!-- Main Content Area -->
      <div class="p-4 rounded-md space-y-6">
        <!-- Title -->
        <div>
          <h2 class="text-base font-semibold text-gray-900">
            RC Setup: Multi-functional Switch B
          </h2>
          <p class="text-sm text-gray-600 mt-1">
            Configure Switch B (two-position <span class="font-semibold">momentary</span> switch).
            Assign it to <span class="font-semibold">Channel 12</span>. Move it to the requested position and press
            <span class="font-semibold">Confirm</span>.
          </p>
        </div>

        <!-- Toggle Buttons -->
        <div class="flex space-x-2 mb-4">
          <!-- Default -->
          <button (click)="setRC('DEFAULT')" [ngClass]="{
            'bg-[#1BAF5D] text-white border-green-600': defaultConfirmed,
            'bg-gray-100 text-gray-700 border-gray-300': !defaultConfirmed
          }" class="px-4 py-2 rounded-full border font-medium flex items-center space-x-1">
            <span *ngIf="defaultConfirmed"><svg width="16" height="11" viewBox="0 0 16 11" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M5.72686 11C5.4067 11 5.10255 10.8772 4.87844 10.6624L0.348174 6.31915C-0.116058 5.87408 -0.116058 5.13743 0.348174 4.69236C0.812406 4.2473 1.58079 4.2473 2.04502 4.69236L5.72686 8.22218L13.955 0.333798C14.4192 -0.111266 15.1876 -0.111266 15.6518 0.333798C16.1161 0.778863 16.1161 1.51552 15.6518 1.96059L6.57529 10.6624C6.35118 10.8772 6.04702 11 5.72686 11Z"
                  fill="white" />
              </svg>
            </span>
            <span>Default</span>
          </button>

          <!-- Engaged -->
          <button (click)="setRC('ENGAGED')" [ngClass]="{
            'bg-[#1BAF5D] text-white border-green-600': engagedConfirmed,
            'bg-gray-100 text-gray-700 border-gray-300': !engagedConfirmed
          }" class="px-4 py-2 rounded-full border font-medium flex items-center space-x-1">
            <span *ngIf="engagedConfirmed"><svg width="16" height="11" viewBox="0 0 16 11" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M5.72686 11C5.4067 11 5.10255 10.8772 4.87844 10.6624L0.348174 6.31915C-0.116058 5.87408 -0.116058 5.13743 0.348174 4.69236C0.812406 4.2473 1.58079 4.2473 2.04502 4.69236L5.72686 8.22218L13.955 0.333798C14.4192 -0.111266 15.1876 -0.111266 15.6518 0.333798C16.1161 0.778863 16.1161 1.51552 15.6518 1.96059L6.57529 10.6624C6.35118 10.8772 6.04702 11 5.72686 11Z"
                  fill="white" />
              </svg>
            </span>
            <span>Engaged</span>
          </button>
        </div>

        <!-- Simulate RC Position -->
        <div>
          <p class="font-medium text-sm mb-2">Simulate RC position (Channel 12)</p>
          <div class="flex gap-2 border border-[#D1DADF] rounded-md overflow-hidden p-4">
            <!-- Default -->
            <button class="flex-1 px-4 py-2 text-sm font-medium transition rounded-md" [ngStyle]="
              currentState === 'DEFAULT'
                ? { border: '2px solid #009169', color: '#009169' }
                : {  color: '#374151' }
            " (click)="setRC('DEFAULT')">
              Default
            </button>

            <button class="flex-1 px-4 py-2 text-sm font-medium transition rounded-md" [ngStyle]="
              currentState === 'ENGAGED'
                ? { border: '2px solid #009169', color: '#009169' }
                : { color: '#374151' }
            " (click)="setRC('ENGAGED')">
              Engaged
            </button>
          </div>
        </div>

        <!-- Stepper Box -->
        <div *ngIf="!finished" class="p-4 border rounded-md bg-white"
          [ngClass]="{ 'border-[#009169] bg-[#f8faf9]': stepActive }">
          <p class="font-medium text-sm">
            Step {{ currentStep }}: {{ currentStepLabel }} Position
          </p>
          <p class="text-sm text-gray-600 mt-1">
            Ensure Switch B is assigned to Channel 12. Move the switch to the
            <span class="font-semibold lowercase">{{ currentStepLabel }}</span> position, then confirm.
          </p>
          <p class="text-sm mt-2">
            Expected state: <span class="font-semibold">{{ currentStepLabel }}</span>
          </p>

          <button class="mt-3 px-4 py-2 rounded-md font-semibold transition text-sm" [ngClass]="{
              'bg-[#009169] text-white hover:bg-[#007e57]': stepActive,
              'bg-gray-200 text-gray-600 cursor-not-allowed': !stepActive
            }" [disabled]="!stepActive" (click)="confirmStep()">
            Confirm {{ currentStepLabel }}
          </button>
        </div>

        <!-- Success Box -->
        <div *ngIf="finished" class="p-4 border border-[#009169] bg-[#f2f9f7] rounded-md text-green-700">
          <p class="font-semibold"><svg width="22" height="22" viewBox="0 0 22 22" fill="none"
              xmlns="http://www.w3.org/2000/svg">
              <path
                d="M11 0C4.939 0 0 4.939 0 11C0 17.061 4.939 22 11 22C17.061 22 22 17.061 22 11C22 4.939 17.061 0 11 0ZM16.258 8.47L10.021 14.707C9.867 14.861 9.658 14.949 9.438 14.949C9.218 14.949 9.009 14.861 8.855 14.707L5.742 11.594C5.423 11.275 5.423 10.747 5.742 10.428C6.061 10.109 6.589 10.109 6.908 10.428L9.438 12.958L15.092 7.304C15.411 6.985 15.939 6.985 16.258 7.304C16.577 7.623 16.577 8.14 16.258 8.47Z"
                fill="#1BAF5D" />
            </svg>
            Switch B configured successfully!</p>
          <p class="text-sm">Switch B is now ready for use.</p>
        </div>
      </div>
    </div>

    <!-- Fixed Bottom Buttons -->
    <div class="fixed bottom-0 left-0 right-0 lg:right-96 flex flex-col md:flex-row justify-between items-center gap-4 p-4 border-t bg-white z-20 shadow-md">
      <button type="button"
        class="bg-red-600 text-white font-semibold py-2 px-6 rounded-md hover:bg-red-700 w-full md:w-auto"
        (click)="onCancelClick()">
        Cancel
      </button>

      <div class="flex gap-4 w-full md:w-auto">
        <button
          class="border border-[#009169] text-gray-700 font-semibold py-2 px-6 rounded-md hover:bg-gray-100 w-full md:w-auto"
          style="border: 1px solid #009169;"
          (click)="back.emit()">
          Back
        </button>
        <button class="text-white font-semibold py-2 px-6 rounded-md transition-colors duration-200 w-full md:w-auto"
          [ngClass]="{
            'bg-[#009169] hover:bg-[#007e57]': allConfirmed,
            'bg-[#80c8b4] cursor-not-allowed': !allConfirmed
          }"
          [disabled]="!allConfirmed" (click)="next.emit()">
          Continue
        </button>
      </div>
    </div>
  </div>

  <!-- Right Sidebar Stepper - Only this will scroll if needed -->
  <div class="w-full lg:w-96 bg-[#cce9e1] h-full overflow-y-auto">
    <div class="p-6 flex flex-col justify-between min-h-full">
      <app-add-drone-stepper [steps]="steps" [currentStepIndex]="currentStepIndex"></app-add-drone-stepper>

      <div class="mt-8">
        <h4 class="text-[22px] font-semibold text-gray-800 mb-1">
          Add A Drone
        </h4>
        <p class="text-[16px] text-gray-600">
          This step ensures your Remote Control is properly configured before
          finalizing the setup.
        </p>
      </div>
    </div>
  </div>
</div>
