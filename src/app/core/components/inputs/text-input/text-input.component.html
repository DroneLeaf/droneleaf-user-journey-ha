<div class="flex flex-col relative">
  <!-- Label -->
  <label class="text-sm font-medium mb-1" [class.required]="required">
    {{ label }}
  </label>

  <div class="relative">
    <!-- Regular input -->
    <ng-container *ngIf="!textarea; else textareaBlock">
      <ion-input [formControl]="control" [placeholder]="placeholder" [type]="inputType" [clearInput]="clearInput"
        [maxlength]="maxlength" shape="round" mode="md" class="border rounded-md px-3 py-2 w-full pr-10"
        [class.error]="showError" [class.success]="isValid"></ion-input>
    </ng-container>

    <!-- Textarea -->
    <ng-template #textareaBlock>
      <textarea [formControl]="control" [placeholder]="placeholder" rows="4"
        class="border-[#009169] border rounded-md px-3 py-2 w-full resize-none focus:outline-none bg-white focus:ring-[#009169]"
        [maxlength]="maxlength" [class.error]="showError" [class.success]="isValid"></textarea>
    </ng-template>

    <!-- ℹ Info icon with tooltip (controlled by showTooltip) -->
<div class="absolute right-3 top-1/2 transform -translate-y-1/2 z-50" *ngIf="showTooltip && tooltipText">
  <div class="relative inline-block group">
    <!-- Info Icon -->
    <img
      src="../../../../../assets/svgs/private/info-icon.svg"
      class="w-5 h-5 text-gray-500 cursor-pointer"
      alt="info icon"
    />

    <!-- Tooltip -->
    <div
      class="absolute left-full ml-1 top-1/2 -translate-y-1/2
             w-[360px] bg-white border border-gray-300 rounded-lg shadow-lg flex
             opacity-0 transition duration-200 ease-in-out
             pointer-events-none
             group-hover:opacity-100 group-hover:pointer-events-auto"
    >
      <!-- Arrow -->
      <div
        class="absolute -left-2 top-1/2 -translate-y-1/2
               w-4 h-4 bg-white border-l border-b border-gray-300 rotate-45"
      ></div>

      <!-- Tooltip Content -->
      <div class="p-3 text-sm text-gray-700 flex text-justify gap-5">
        {{ tooltipText }}
        <img *ngIf="tooltipImage" [src]="tooltipImage" alt="tooltip" class="mt-2 w-20 h-auto" />
      </div>
    </div>
  </div>
</div>






    <!-- ✅ Validation status icons -->
    <div class="absolute right-8 top-1/2 transform -translate-y-1/2" *ngIf="control?.touched">
      <svg *ngIf="showError" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-red-500" fill="none"
        viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M12 8v4m0 4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
      </svg>
      <svg *ngIf="isValid" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-green-500" fill="none"
        viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
      </svg>
    </div>



    <!-- 👁 Password visibility toggle -->
    <ion-icon *ngIf="type === 'password'" [name]="showPassword ? 'eye-off' : 'eye'"
      class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 cursor-pointer z-10"
      (click)="togglePasswordVisibility()"></ion-icon>

    <!-- ✅ Validation status icons -->
    <div class="absolute right-8 top-1/2 transform -translate-y-1/2" *ngIf="control?.touched">
      <ion-icon *ngIf="showError" name="alert-circle" class="text-red-500 text-lg"></ion-icon>
      <ion-icon *ngIf="isValid" name="checkmark-circle" class="text-green-500 text-lg"></ion-icon>
    </div>
  </div>

  <!-- Helper text -->
  <div *ngIf="helperText && !showError" class="helper-text" [id]="'helper-' + generateId()">
    {{ helperText }}
  </div>

  <!-- Error message -->
  <div *ngIf="showError" class="error-message" [id]="'error-' + generateId()" role="alert">
    <ion-icon name="alert-circle" class="error-icon"></ion-icon>
    {{ getErrorMessage() }}
  </div>

  <!-- Character count -->
  <div *ngIf="maxlength && control?.value" class="character-count">
    {{ (control?.value || '').length }}/{{ maxlength }}
  </div>
</div>
